# Лабораторная работа №2  
## Логирование, мониторинг и визуализация

**Дисциплина:** Коммуникационные сервисы  
**Факультет:** Программной инженерии и компьютерной техники  
**Университет:** ИТМО  

**Студенты:** Тутубалин Кирилл, Москалец Данила, Захматов Юрий, Джафари Хоссаин, Мохаджер Али Реза  
**Группа:** К3340–К3341  
**Преподаватель:** Самохин Никита Юрьевич  

**Санкт-Петербург, 2025 г.**

---

## 1. Цель работы

Целью лабораторной работы является изучение принципов построения системы логирования, мониторинга и визуализации состояния веб-приложения на основе стека современных инструментов observability.

---

## 2. Используемое программное обеспечение

- Docker, Docker Compose  
- Nextcloud (`nextcloud:29.0.6`)  
- Grafana Loki (`grafana/loki:2.9.0`)  
- Promtail (`grafana/promtail:2.9.0`)  
- Grafana (`grafana/grafana:11.2.0`)  
- PostgreSQL 15  
- Zabbix Server и Zabbix Web  

---

## 3. Ход работы

### 3.1. Подготовка окружения

Подключение к удалённому серверу выполнено по протоколу SSH.

![Подключение по SSH](screenshots/1.png)

Файлы лабораторной работы были переданы на сервер.

![Передача файлов](screenshots/2.png)

После этого все сервисы были запущены с использованием Docker Compose.

![Запуск Docker Compose](screenshots/3.png)

Проверено, что все контейнеры успешно работают.

![Статус контейнеров](screenshots/4.png)

Также проверена доступность сетевых портов сервисов.

![Проверка портов](screenshots/5.png)

---

### 3.2. Инициализация Nextcloud

В браузере был открыт веб-интерфейс Nextcloud и запущен мастер первоначальной настройки.

![Мастер установки Nextcloud](screenshots/6.png)

Создана учётная запись администратора.

![Создание учётной записи](screenshots/7.png)

После завершения установки открыта главная страница приложения.

![Главная страница Nextcloud](screenshots/8.png)

Для генерации логов были выполнены пользовательские действия (загрузка и удаление файлов).

![Работа с файлами](screenshots/9.png)

---

### 3.3. Настройка системы логирования (Promtail и Loki)

Promtail был настроен для сбора логов Nextcloud и их отправки в Loki.

![Конфигурация Promtail](screenshots/9.png)

Проверена корректная работа Loki и приём логов.

![Проверка Loki](screenshots/21.png)

В Grafana выполнен просмотр логов Nextcloud через Loki.

![Логи в Grafana](screenshots/27.png)

Также выполнены запросы для анализа логов.

![PromQL Builder](screenshots/25.png)  
![Результат запроса](screenshots/26.png)

---

### 3.4. Настройка мониторинга (Zabbix)

Выполнен вход в веб-интерфейс Zabbix.

![Вход в Zabbix](screenshots/10.png)

Импортирован шаблон мониторинга Nextcloud.

![Раздел шаблонов](screenshots/11.png)  
![Импорт шаблона](screenshots/12.png)

Создан хост для мониторинга сервиса и к нему применён шаблон.

![Создание хоста](screenshots/14.png)  
![Настройка хоста](screenshots/15.png)

Проверена корректность сбора данных мониторинга.

![Последние данные](screenshots/16.png)  
![Данные мониторинга](screenshots/17.png)

Также проверена работа триггеров Zabbix.

![Статус триггеров](screenshots/28.png)  
![Работа мониторинга](screenshots/23.png)

---

### 3.5. Визуализация в Grafana

Выполнен вход в Grafana.

![Интерфейс Grafana](screenshots/20.png)

Добавлен источник данных Loki.

![Настройка Loki](screenshots/21.png)

Добавлен источник данных Zabbix.

![Настройка Zabbix](screenshots/22.png)

Созданы дашборды для отображения логов и метрик.

![Дашборд с логами](screenshots/24.png)  
![Дашборд с метриками](screenshots/18.png)  
![Дашборд Zabbix](screenshots/19.png)

---

## 4. Результат: итоговый дашборд Grafana

В результате выполнения лабораторной работы был создан итоговый дашборд Grafana, объединяющий данные логирования и мониторинга веб-приложения Nextcloud.

Итоговый дашборд позволяет в едином интерфейсе отслеживать состояние сервиса и анализировать события, зафиксированные в логах.

![Итоговый дашборд Grafana](screenshots/24.png)

*Рисунок — Итоговый дашборд Grafana с логами Loki и метриками Zabbix*

### Выводы по итоговому дашборду
- Итоговый дашборд предоставляет целостное представление о состоянии сервиса.
- События в логах коррелируют с изменениями состояния, зафиксированными системой мониторинга.
- Использование Grafana упрощает анализ инцидентов и повышает наблюдаемость сервиса.

---

## 5. Ответы на контрольные вопросы

### 5.1. Чем SLO отличается от SLA?

SLA — это юридическое соглашение с клиентом, определяющее уровень предоставляемого сервиса.  
SLO — это внутренние целевые показатели качества сервиса.

---

### 5.2. Чем отличается инкрементальный бэкап от дифференциального?

Дифференциальный бэкап содержит все изменения с момента последнего полного бэкапа.  
Инкрементальный бэкап содержит изменения с момента последнего бэкапа любого типа.

---

### 5.3. В чём разница между мониторингом и observability?

Мониторинг позволяет определить наличие проблемы.  
Observability позволяет понять причины возникновения проблемы.

---

## 6. Вывод

В ходе лабораторной работы был развёрнут комплекс сервисов для логирования, мониторинга и визуализации состояния веб-приложения Nextcloud.  
Поставленные цели лабораторной работы были достигнуты.

---

### Приложения
- `docker-compose.yml`
- `promtail_config.yml`
- `template.yml`
- папка `screenshots/`
