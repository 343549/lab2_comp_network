# Лабораторная работа №2

## Ход работы

### Часть 1. Логирование

#### Запуск docker-compose.yml
Для запуска всех сервисов используется команда:
```bash
docker-compose up -d
```

Это запускает следующие сервисы:
- Nextcloud на порту 8080
- Loki на порту 3100
- Promtail для сбора логов
- Grafana на порту 3000

<!-- TODO: Добавить скриншот запуска docker-compose или результата docker-compose ps -->
![Запуск docker-compose](screenshots/01_docker_compose_up.png)

#### Инициализируем Nextcloud
После запуска контейнеров необходимо:
1. Открыть браузер и перейти на http://localhost:8080
2. Создать административный аккаунт
3. Настроить базу данных (можно использовать SQLite для простоты)
4. Завершить установку

<!-- TODO: Добавить скриншоты настройки Nextcloud -->
![Настройка Nextcloud](screenshots/02_nextcloud_setup.png)
![Создание административного аккаунта](screenshots/03_nextcloud_account.png)
![Главная страница Nextcloud](screenshots/04_nextcloud_home.png)

### Часть 2. Мониторинг

#### Настраиваем Zabbix
1. Открыть Zabbix Web UI: http://localhost:8082
2. Войти с учетными данными по умолчанию (Admin/zabbix)
3. Импортировать шаблон из файла template.yml
4. Настроить хост для мониторинга Nextcloud
5. Применить шаблон к хосту

<!-- TODO: Добавить скриншоты настройки Zabbix -->
![Вход в Zabbix](screenshots/05_zabbix_login.png)
![Импорт шаблона](screenshots/06_zabbix_template_import.png)
![Создание хоста](screenshots/07_zabbix_host_create.png)
![Настроенный хост с шаблоном](screenshots/08_zabbix_host_configured.png)
![Данные мониторинга](screenshots/09_zabbix_monitoring_data.png)

### Часть 3. Визуализация (Grafana)

#### Устанавливаем плагины
В Grafana необходимо установить плагин для Zabbix:
1. Перейти в Configuration → Plugins
2. Найти и установить плагин "Zabbix"

<!-- TODO: Добавить скриншот установки плагина Zabbix -->
![Установка плагина Zabbix](screenshots/10_grafana_zabbix_plugin.png)

#### Настраиваем Loki (data source)
1. Перейти в Configuration → Data Sources
2. Добавить новый data source типа "Loki"
3. Указать URL: http://loki:3100
4. Сохранить и протестировать подключение

<!-- TODO: Добавить скриншоты настройки Loki -->
![Добавление источника данных Loki](screenshots/11_grafana_loki_add.png)
![Тест подключения к Loki](screenshots/12_grafana_loki_test.png)

#### Настраиваем Zabbix (data source)
1. В Configuration → Data Sources добавить "Zabbix"
2. Указать URL Zabbix API: http://zabbix-front:8080/api_jsonrpc.php
3. Ввести учетные данные (Admin/zabbix)
4. Сохранить и протестировать подключение

<!-- TODO: Добавить скриншоты настройки Zabbix data source -->
![Добавление источника данных Zabbix](screenshots/13_grafana_zabbix_add.png)
![Тест подключения к Zabbix](screenshots/14_grafana_zabbix_test.png)

#### Отображение данных
Создать дашборды в Grafana для:
- Логов Nextcloud из Loki
- Метрик мониторинга из Zabbix
- Комбинированные визуализации

<!-- TODO: Добавить скриншоты отображения данных -->
![Панель с логами из Loki](screenshots/15_grafana_loki_panel.png)
![Панель с метриками из Zabbix](screenshots/16_grafana_zabbix_panel.png)
![Комбинированная визуализация](screenshots/17_grafana_combined.png)

#### Создание dashboards
1. Создать новый dashboard
2. Добавить панели для отображения:
   - Логи приложений (Logs panel с запросами к Loki)
   - Метрики доступности (Graph panel с данными из Zabbix)
   - Статус сервисов (Stat panel)

<!-- TODO: Добавить скриншоты финального дашборда -->
![Финальный дашборд Grafana](screenshots/18_grafana_dashboard_final.png)
![Дашборд с несколькими панелями](screenshots/19_grafana_dashboard_panels.png)

## Ответы на вопросы

> Чем SLO отличается от SLA?

- SLA (Service Level Agreement) – юридическое соглашение между поставщиком услуг и клиентом, которое определяет условия предоставления услуги. Например, минимальный допустимый уровень доступности сервиса 99,9% времени. При нарушении договорённостей вводятся санкции, прописанные в договоре, например, возврат части средств.
- SLO (Service Level Objective) - это целевые значения метрик, которые используются для внутреннего контроля работоспособности сервисов и услуг. Например, цель, к которой стремится команда разработки.

> Чем отличается инкрементальный бэкап от дифференциального?

- Дифференциальный бэкап – копируются все данные, измененные с момента последнего полного бэкапа. Для восстановления потребуется полный бэкап и последний дифференциальный.
- Инкрементальный бэкап – копируются все данные, измененные с момента любого последнего бэкапа. Выигрывает по размеру, но для восстановления потребуется полный бэкап и все инкрементальные бэкапы по порядку.

> В чем разница между мониторингом и observability?

- Мониторинг (реактивный подход) — отслеживание заранее известных метрик.
- Observability (проактивный подход) — это возможность понять поведение системы на основе данных (логов, метрик, трассировок), даже если проблема ранее не была предсказана.

